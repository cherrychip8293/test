<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì´ìŠ¬ë¹„ í”„ë¡œì íŠ¸</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style/rank.css">
</head>
<body>

<!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
<nav class="navbar navbar-expand-lg bg-white">
    <div class="container-fluid">
        <a class="navbar-brand" href="index.html">
            <img src="image/icon.png" alt="Logo">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto"> <!-- ms-autoë¥¼ me-autoë¡œ ë³€ê²½í•˜ì—¬ ì™¼ìª½ ì •ë ¬ -->
                <!-- ì•½ê´€ê³¼ ìš´ì˜ì§„ ì†Œê°œ ë“œë¡­ë‹¤ìš´ -->
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        ìš´ì˜ê´€ë ¨
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                        <li><a class="dropdown-item" href="rule.html">ì„œë²„ ì•½ê´€</a></li>
                        <li><a class="dropdown-item" href="staff.html">ìš´ì˜ì§„ ì†Œê°œ</a></li>
                    </ul>
                    <li class="nav-item">
                        <a class="nav-link" href="status.html">ì„œë²„ ìƒíƒœ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="rank.html">ë­í‚¹</a>
                    </li>
                </li>
            </ul>
        </div>
    </div>
</nav>


<div class="container-fluid-1">
    <h1 class="page-title">ëˆ ìˆœìœ„</h1>
    
    <div class="top-ranks" id="topRanks">
        <!-- Top 3 ranks will be inserted here -->
    </div>

    <div class="other-ranks" id="otherRanks">
        <!-- Ranks 4-10 will be inserted here -->
    </div>
</div>

<!-- í‘¸í„° -->
<footer class="bg-dark mt-auto">
  <div class="container-fluid p-4" id="footerContainer">
      <p>ìƒí˜¸ëª…: ì´ìŠ¬ë¹„ í”„ë¡œì íŠ¸ | ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 526-43-00789 | í†µì‹ íŒë§¤ë²ˆí˜¸: 2022-ëŒ€ì „ëŒ€ë•-0460 | ëŒ€í‘œ: ë°±ê²½ìš°</p>
      <p>&copy Copyright 2024. Cloud Studio All rights reserved.</p>
  </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function formatKoreanNumber(number) {
            const units = ['', 'ë§Œ', 'ì–µ', 'ì¡°', 'ê²½'];
            let result = '';
            let num = number;
            let unitIndex = 0;

            while (num > 0 && unitIndex < units.length) {
                const part = num % 10000;
                if (part > 0) {
                    result = part + units[unitIndex] + ' ' + result;
                }
                num = Math.floor(num / 10000);
                unitIndex++;
            }

            return result.trim() || '0';
        }

        function loadRankings() {
            fetch('http://localhost:5000/rankings')
                .then(response => response.json())
                .then(data => {
                    const topRanks = document.getElementById('topRanks');
                    const otherRanks = document.getElementById('otherRanks');
                    
                    // Clear previous content
                    topRanks.innerHTML = '';
                    otherRanks.innerHTML = '';

                    // Process top 3 ranks
                    const top3 = data.slice(0, 3);
                    const rankOrder = [2, 1, 3];
                    
                    rankOrder.forEach(rank => {
                        const player = top3.find(p => p.rank === rank);
                        if (player) {
                            const formattedAmount = formatKoreanNumber(player.amount);
                            const card = document.createElement('div');
                            card.className = `rank-card ${rank === 1 ? 'rank-1' : ''}`;
                            card.innerHTML = ` 
                                <div class="medal-icon">${rank === 1 ? 'ğŸ¥‡' : rank === 2 ? 'ğŸ¥ˆ' : 'ğŸ¥‰'}</div>
                                <img src="https://skin.blockf.kr/get/${player.xuid}_wallpaper.png" 
                                     alt="Player skin" 
                                     class="player-avatar top-player-avatar"
                                     onerror="this.src='https://skin.blockf.kr/get/default_wallpaper.png'">
                                <div class="player-name">${player.player_name || 'Unknown Player'}</div>
                                <div class="player-amount">${formattedAmount}</div>
                            `;
                            topRanks.appendChild(card);
                        }
                    });

                    // Process ranks 4-10
                    const others = data.slice(3, 10);
                    others.forEach(player => {
                        const formattedAmount = formatKoreanNumber(player.amount);
                        const row = document.createElement('div');
                        row.className = 'rank-row';
                        row.innerHTML = `
                            <div class="rank-number">${player.rank}ìœ„</div>
                            <div class="rank-player">
                                <img src="https://skin.blockf.kr/get/${player.xuid}_wallpaper.png" 
                                     alt="Player skin"
                                     onerror="this.src='https://skin.blockf.kr/get/default_wallpaper.png'">
                                <span>${player.player_name || 'Unknown Player'}</span>
                            </div>
                            <div class="rank-amount">${formattedAmount}</div>
                        `;
                        otherRanks.appendChild(row);
                    });
                })
                .catch(error => {
                    console.error('Error loading rankings:', error);
                    alert('ìˆœìœ„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                });
        }

        document.addEventListener('DOMContentLoaded', loadRankings);
    </script>
</body>
</html>